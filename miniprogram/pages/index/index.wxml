<!--index.wxml-->
<navigation-bar back="{{false}}" title="音乐列表"></navigation-bar>

<scroll-view wx:if="{{!!list.length}}" class="flex-1 overflow-y-hidden px-4 box-border" scroll-y type="list"
  show-scrollbar="{{false}}">
  <view wx:for="{{list}}" wx:key="*this"
    class="flex items-baseline py-4 border-b border-solid border-gray-100 dark:border-neutral-800 border-opacity-80 last:border-none"
    data-name="{{item.name}}" bind:tap="handleViewTap">
    <view class="truncate">
      {{item.name}}
    </view>
    <view class="text-xs scale-90 opacity-80 flex-shrink-0">(共 {{item.count}} 首)</view>
  </view>
</scroll-view>

<view wx:if="{{!configured || !connected}}" class="flex-1 flex justify-center items-center">
  <view wx:if="{{!configured}}" class="p-4">
    <view class="flex items-center justify-center">
      <text>该小程序需配合</text>
      <text class="mx-1 -mb-1 text-blue-600" bind:tap="handleRepoLink">xiaomusic</text>
      <text>服务使用</text>
    </view>
    <view class="mt-2">
      <text class="text-sm">最简部署步骤</text>
      <view class="p-2 mt-2 text-sm text-gray-600 bg-gray-100 dark:bg-neutral-800 dark:text-gray-300 rounded">
        <text>docker run -p 8090:8090 \</text>
        <text class="ml-4">-v /xiaomusic/music:/app/music \</text>
        <text class="ml-4">-v /xiaomusic/conf:/app/conf \</text>
        <text class="ml-4">hanxi/xiaomusic</text>
      </view>
    </view>
    <button class="mt-4" bind:tap="handleSetting">服务配置</button>
  </view>
  <view wx:else>
    <view class="text-center">网络异常，请在局域网环境下使用</view>
    <button class="mt-4" bind:tap="handleSetting">服务配置</button>
  </view>
</view>